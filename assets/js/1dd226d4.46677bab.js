"use strict";(self.webpackChunknada=self.webpackChunknada||[]).push([[759],{3905:function(e,t,n){n.d(t,{Zo:function(){return d},kt:function(){return m}});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var c=r.createContext({}),u=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},d=function(e){var t=u(e.components);return r.createElement(c.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},s=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,c=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),s=u(n),m=o,h=s["".concat(c,".").concat(m)]||s[m]||p[m]||a;return n?r.createElement(h,i(i({ref:t},d),{},{components:n})):r.createElement(h,i({ref:t},d))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=s;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:o,i[1]=l;for(var u=2;u<a;u++)i[u]=n[u];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}s.displayName="MDXCreateElement"},3728:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return c},metadata:function(){return u},toc:function(){return d},default:function(){return s}});var r=n(7462),o=n(3366),a=(n(7294),n(3905)),i=["components"],l={title:"Cloud Scheduler"},c=void 0,u={unversionedId:"process-data/gcp/pipelines/cloud-scheduler",id:"process-data/gcp/pipelines/cloud-scheduler",isDocsHomePage:!1,title:"Cloud Scheduler",description:"With Google Cloud Scheduler you set up scheduled units of work to be executed at defined times or regular intervals. These work units are commonly known as cron jobs. Typical use cases might include sending out a report email on a daily basis, updating some cached data every 10 minutes, or updating some summary information once an hour.",source:"@site/docs/process-data/gcp/pipelines/cloud-scheduler.md",sourceDirName:"process-data/gcp/pipelines",slug:"/process-data/gcp/pipelines/cloud-scheduler",permalink:"/process-data/gcp/pipelines/cloud-scheduler",editUrl:"https://github.com/navikt/nada/edit/master/docs/process-data/gcp/pipelines/cloud-scheduler.md",tags:[],version:"current",frontMatter:{title:"Cloud Scheduler"},sidebar:"docs",previous:{title:"Cloud Function",permalink:"/process-data/gcp/pipelines/cloud-functions"},next:{title:"Getting started",permalink:"/process-data/onprem/getting-started"}},d=[{value:"Example",id:"example",children:[{value:"Create service account",id:"create-service-account",children:[]},{value:"Create a Cloud Scheduler",id:"create-a-cloud-scheduler",children:[]}]}],p={toc:d};function s(e){var t=e.components,n=(0,o.Z)(e,i);return(0,a.kt)("wrapper",(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"With ",(0,a.kt)("a",{parentName:"p",href:"https://cloud.google.com/scheduler"},"Google Cloud Scheduler")," you set up scheduled units of work to be executed at defined times or regular intervals. These work units are commonly known as cron jobs. Typical use cases might include sending out a report email on a daily basis, updating some cached data every 10 minutes, or updating some summary information once an hour.")),(0,a.kt)("p",null,"You can find the official documentation for Cloud Scheduler at ",(0,a.kt)("a",{parentName:"p",href:"https://cloud.google.com/scheduler/docs"},"cloud.google.com"),"."),(0,a.kt)("h2",{id:"example"},"Example"),(0,a.kt)("p",null,"This guide requires that you have completed the guide in ",(0,a.kt)("a",{parentName:"p",href:"cloud-functions#eksempel"},"Cloud Functions")," and created a Cloud Function.\nWe now use Cloud Scheduler to trigger this cloud function periodically."),(0,a.kt)("h3",{id:"create-service-account"},"Create service account"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Go to ",(0,a.kt)("inlineCode",{parentName:"li"},"IAM & Admin")),(0,a.kt)("li",{parentName:"ol"},"Create service account with the following roles:",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"Cloud Functions Invoker")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"Cloud Scheduler Admin")))),(0,a.kt)("li",{parentName:"ol"},"Note the .iam.gserviceaccount.com email of the service accounten")),(0,a.kt)("h3",{id:"create-a-cloud-scheduler"},"Create a Cloud Scheduler"),(0,a.kt)("p",null,"From ",(0,a.kt)("a",{parentName:"p",href:"https://console.cloud.google.com/cloudscheduler"},"Cloud scheduler")," press ",(0,a.kt)("inlineCode",{parentName:"p"},"CREATE JOB"),"."),(0,a.kt)("p",null,"The following must be specified:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("inlineCode",{parentName:"li"},"Name")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("inlineCode",{parentName:"li"},"Frequency")," - ",(0,a.kt)("a",{parentName:"li",href:"https://en.wikipedia.org/wiki/Cron"},"cron")," string"),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("inlineCode",{parentName:"li"},"Timezone")," - set to ",(0,a.kt)("inlineCode",{parentName:"li"},"Central European Standard Time (CET)")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("inlineCode",{parentName:"li"},"Target")," - set to ",(0,a.kt)("inlineCode",{parentName:"li"},"HTTP")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("inlineCode",{parentName:"li"},"URL")," - set to the Trigger URL of the ",(0,a.kt)("a",{parentName:"li",href:"cloud-functions#eksempel"},"Cloud Function")," created earlier"),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("inlineCode",{parentName:"li"},"HTTP method")," - set to POST"),(0,a.kt)("li",{parentName:"ol"},"Set Auth header to ",(0,a.kt)("inlineCode",{parentName:"li"},"Add OIDC token")," and enter the service account email created in ",(0,a.kt)("a",{parentName:"li",href:"#create-service-account"},"Create service account"))),(0,a.kt)("p",null,"Finally, press ",(0,a.kt)("inlineCode",{parentName:"p"},"CREATE"),"."),(0,a.kt)("p",null,"You have now created a job that triggers your cloud function periodically."))}s.isMDXComponent=!0}}]);